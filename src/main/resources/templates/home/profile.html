<!DOCTYPE html>
<html th:replace="~{layout/homeLayoutForm::layout (~{::header},~{::section})}">
<header>
  <a href="/"><span>프로필</span></a>
  <a href="/member/logout"><p>로그아웃</p>
    <img src="/img/logout.png" alt="logout.png"
    /></a>
</header>
<section>
  <div class="image-container">
    <a id="editButton">
      <img th:if="${member?.profileImageUrl}" th:src="${member?.profileImageUrl}"/>
      <img th:unless="${member?.profileImageUrl}" src="img/profile2.png"/>
      <img class="camera" src="/img/camera.png"/>
    </a>
  </div>
  <div class="info-container">
    <p class="item1" th:text="${member.name}">name</p>
    <div class="email">
      <p class="item2" th:text="${member.email}">email</p>
      <button th:if="${member.roles.iterator().next()=='AUTH_USER'}" class="email-button">인증완료</button>
      <button th:unless="${member.roles.iterator().next()=='AUTH_USER'}" class="email-button" id="email-button">인증
      </button>
    </div>
    <hr/>
    <div class="day">
      <p class="item3">가입일</p>
      <p class="item4"
         th:text="${#temporals.format(member.createdAt,'yy년 MM월 dd일')}"
      >
        가입일
      </p>
    </div>
  </div>
  <h3>내가만든모임</h3>
  <div class="create-container">
    <p th:if="${member.createMoims.isEmpty()}" style="color: #948f8f;font-size: 15px;">만든 모임이 아직 없어요.</p>
    <div class="createdMoim" th:each="moim:${member.createMoims}">
      <div>
        <p th:text="${#temporals.format(moim.startedAt, 'MM월/dd일 (E)')}" style="font-size: 10px; font-weight: bold;"></p>
        <p th:text="${moim.title}"></p>
      </div>
      <a th:href="@{/moims/edit-page/{moimId}(moimId=${moim.id})}">관리</a>
    </div>
  </div>
  <h3>참여한 모임</h3>
  <div class="join-container">
    <p th:if="${member.joinMoims.isEmpty()}" style="color: #948f8f; font-size: 15px;">참여한 모임이 아직 없어요.</p>
    <div th:each="moim:${member.joinMoims}">
    <a th:href="@{/moims/{moimId}(moimId=${moim.id})}">
    <div class="joinMoim">
      <p th:text="${moim.title}"></p>
      <span th:text="${#temporals.format(moim.startedAt, 'MM월/dd일 (E)')}"></span>
    </div>
    </a>
    </div>
  </div>
  <h3>좋아요❤️모임</h3>
  <div class="like-container">
    <p th:if="${member.likeMoims.isEmpty()}" style="color: #948f8f; font-size: 15px;">좋아요한 모임이 아직 없어요.</p>
    <div th:each="moim:${member.likeMoims}">
      <a th:href="@{/moims/{moimId}(moimId=${moim.id})}">
        <div class="likeMoim">
          <p th:text="${moim.title}"></p>
          <span th:text="${#temporals.format(moim.startedAt, 'MM월/dd일 (E)')}"></span>
        </div>
      </a>
    </div>
  </div>
  <h3>최근본 <span style="font-size:15px">o_o </span>모임</h3>
  <div class="latest-container">
    <p th:if="${latest.isEmpty()}" style="color: #948f8f; font-size: 15px;">최근 본 모임이 아직 없어요.</p>
    <div th:each="moim:${latest}">
      <a th:href="@{/moims/{moimId}(moimId=${moim.moimId})}">
        <div class="latestMoim">
          <p th:text="${moim.title}"></p>
          <span th:text="${#temporals.format(moim.startedAt, 'MM월/dd일 (E)')}"></span>
        </div>
      </a>
    </div>
  </div>

  <script th:inline="javascript">

    var memberId = /*[[${member.id}]]*/ '';

    var editButton = document.getElementById('editButton');

    editButton.addEventListener('click', function () {
      window.location.href = '/members/edit_form'

    });

    const emailButton = document.getElementById('email-button');

    emailButton.addEventListener('click',function (){
      window.location.href='/email/auth-form'
    })
  </script>

</section>
